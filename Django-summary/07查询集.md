# 查询集

**查询集**：表示从数据库中获取的模型对象集合
- **在管理器上调用过滤器方法会返回查询集**
- 查询集可以含有0个、一个或多个过滤器

**过滤器**：基于所给的参数限制查询的结果

提示：从sql的角度，**查询集和select语句等价，过滤器像where和limit子句**

返回列表的过滤器如下：
- all()：返回所有的数据
- filter()：返回满足条件的数据
- exclude()：返回满足条件之外的数据，相当于sql语句中where部分的not关键字
- order_by()：返回排序后的数据

返回单个对象的过滤器如下：
- get()：返回单个满足条件的对象
	- 如果未找到会引发"模型类.DoesNotExist"异常
	-如果多条被返回，会引发"模型类.MultipleObjectsReturned"异常
-  count()：返回当前查询的总条数
- **aggregate()：聚合**
- exists()：判断查询集中是否有数据，如果有则返回True，没有则返回False
- 
**raw():可在括号内直接使用mysql语句**

### 查询集特点
1.**惰性执行：创建查询集不会访问数据库，直到在模板中调用数据时，才会访问数据库**
- **调用数据的情况包括迭代、序列化、与if合用**

2.**缓存**：查询集的结果被存下来之后，**再次查询相同数据时会使用之前缓存的数据**

### 查询集缓存
每个查询集都包含一个缓存来最小化对数据库的访问

第一次查询数据后，Django会将查询集缓存起来，并返回请求的结果

再次查询相同数据时将重用缓存的结果

### 限制查询集
- 查询集返回列表，可以使用下标的方式进行限制（切片），等同于sql中的limit和offset子句
- 注意：不支持负数索引
- 使用下标后返回一个新的查询集，不会立即执行查询
- 如果获取一个对象，直接使用[0]，等同于[0:1].get()
- 但是如果没有数据，[0]引发IndexError异常，[0:1].get()引发DoesNotExist异常